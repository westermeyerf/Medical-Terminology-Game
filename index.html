<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="viewport" content="width=device-width, initial-scale=1.0">
    <title>Medical Terminology Matching Game</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            background-color: #1e1e1e;
            color: #d3d3d3;
            text-align: center;
            padding: 20px;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #333;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            border-radius: 10px;
        }
        h1 {
            color: #4CAF50;
        }
        .term-container {
            display: flex;
            justify-content: space-around;
            margin-bottom: 20px;
        }
        .term-box, .drop-zone {
            width: 120px;
            padding: 15px;
            margin-right: 10px;
            background-color: #444;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
            transition: background-color 0.3s ease;
            cursor: pointer;
            color: #d3d3d3;
        }
        .drop-zone {
            background-color: #555;
            border: 2px dashed #888;
        }
        .term-box:hover {
            background-color: #555;
        }
        .score {
            margin-top: 20px;
            font-size: 1.2em;
        }
        #result {
            margin-top: 20px;
            font-size: 1.2em;
            color: #d3d3d3;
        }
        #hint {
            display: none;
            background-color: #666;
            color: #f0f0f0;
            padding: 10px;
            margin-top: 20px;
            border-radius: 5px;
        }
        #instruction {
            font-size: 1.2em;
            margin-bottom: 20px;
            color: #d3d3d3;
        }
        .buttons {
            margin-top: 20px;
        }
        button {
            padding: 10px 20px;
            margin: 5px;
            border: none;
            border-radius: 5px;
            background-color: #4CAF50;
            color: white;
            font-size: 1em;
            cursor: pointer;
        }
        button:hover {
            background-color: #45a049;
        }
        .leaderboard {
            margin-top: 30px;
            background-color: #222;
            color: #ffffff;
            padding: 20px;
            border-radius: 10px;
        }
        .leaderboard h2 {
            margin-bottom: 15px;
        }
        .leaderboard ol {
            padding-left: 20px;
        }
        .leaderboard li {
            text-align: left;
            display: flex;
            align-items: center;
        }
        .medal {
            margin-right: 10px;
        }
        .gold {
            color: #ffd700;
        }
        .silver {
            color: #c0c0c0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Medical Terminology Matching Game</h1>

        <!-- Player Name Input -->
        <div>
            <label for="playerName">Enter your name: </label>
            <input type="text" id="playerName" placeholder="Your Name">
        </div>

        <div id="instruction"></div> <!-- Term instruction will go here -->

        <div class="term-container" id="term-container">
            <!-- Terms for Prefixes, Roots, Suffixes will be inserted dynamically -->
        </div>

        <div class="term-container">
            <div class="drop-zone" id="prefix-zone">Prefix</div>
            <div class="drop-zone" id="root-zone">Root</div>
            <div class="drop-zone" id="suffix-zone">Suffix</div>
        </div>

        <div class="score">
            <p>Score: <span id="score">0</span></p>
        </div>

        <div id="result"></div>

        <div class="buttons">
            <button onclick="submitAttempt()">Submit Answer</button>
            <button onclick="showHint()">Show Hint</button>
            <button onclick="resetGame()">Reset Game</button>
        </div>

        <div id="hint"></div>
    </div>

    <!-- Leaderboard -->
    <div class="leaderboard">
        <h2>Top 10 Leaderboard</h2>
        <ol id="leaderboard-list">
            <!-- Leaderboard items will be dynamically inserted here -->
        </ol>
    </div>

    <script>
        let score = 0;
        let currentTermIndex = 0;
        let attempts = 0;  // To track the number of attempts
        const maxOptions = 9;  // Limit number of options

        const terms = [
            { prefix: "hypo-", root: "glyc", suffix: "-emia", meaning: "Low blood sugar", hint: "Low sugar in the blood" },
            { prefix: "hyper-", root: "tens", suffix: "-ion", meaning: "High blood pressure", hint: "Elevated blood pressure" },
            { prefix: "brady-", root: "card", suffix: "-ia", meaning: "Slow heart rate", hint: "Slowed heart rate" },
            { prefix: "tachy-", root: "card", suffix: "-ia", meaning: "Fast heart rate", hint: "Fast heartbeat" }
            // Add more terms here...
        ];

        const falseOptions = {
            prefix: ["pre-", "hypo-", "peri-", "ante-", "poly-"],
            root: ["algia", "cardio", "itis", "neur", "dipsia"],
            suffix: ["-osis", "-ectomy", "-pathy", "-emia", "-plasty"]
        };

        const leaderboard = JSON.parse(localStorage.getItem("leaderboard")) || [];

        window.onload = function() {
            shuffle(terms); // Shuffle the terms array before starting
            loadTerm();
            displayLeaderboard();
        };

        function loadTerm() {
            const term = terms[currentTermIndex];
            let termContainer = document.getElementById("term-container");

            document.getElementById("instruction").innerHTML = `Identify the medical term for: <strong>${term.meaning}</strong>`;

            const components = [
                { type: "prefix", text: term.prefix },
                { type: "root", text: term.root },
                { type: "suffix", text: term.suffix }
            ];

            // Select a few random false options to add to the display
            const selectedFalseOptions = {
                prefix: selectRandomOptions(falseOptions.prefix, 3),
                root: selectRandomOptions(falseOptions.root, 3),
                suffix: selectRandomOptions(falseOptions.suffix, 3)
            };

            const allOptions = [...components, 
                ...selectedFalseOptions.prefix.map(text => ({ type: "prefix", text })),
                ...selectedFalseOptions.root.map(text => ({ type: "root", text })),
                ...selectedFalseOptions.suffix.map(text => ({ type: "suffix", text }))
            ];

            shuffle(allOptions);

            // Limit the number of displayed options to maxOptions
            const displayedOptions = allOptions.slice(0, maxOptions);

            termContainer.innerHTML = "";

            displayedOptions.forEach(option => {
                if (option.text) {
                    let termBox = document.createElement("div");
                    termBox.classList.add("term-box");
                    termBox.setAttribute("draggable", "true");
                    termBox.setAttribute("data-type", option.type);
                    termBox.innerHTML = option.text;
                    termContainer.appendChild(termBox);

                    termBox.addEventListener("dragstart", function(e) {
                        e.dataTransfer.setData("text", e.target.innerHTML);
                        e.dataTransfer.setData("type", e.target.getAttribute("data-type"));
                    });
                }
            });

            attempts = 0;
        }

        function shuffle(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
        }

        function selectRandomOptions(array, count) {
            const shuffled = array.slice();
            shuffle(shuffled);
            return shuffled.slice(0, count);
        }

        document.querySelectorAll('.drop-zone').forEach(zone => {
            zone.addEventListener('dragover', function (e) {
                e.preventDefault();
            });

            zone.addEventListener('drop', function (e) {
                e.preventDefault();
                const draggedText = e.dataTransfer.getData("text");
                const draggedType = e.dataTransfer.getData("type");
                
                if (e.target.id.includes(draggedType)) {
                    e.target.innerHTML = draggedText;
                } else {
                    document.getElementById("result").innerHTML = "Incorrect zone! Try again.";
                }
            });
        });

        function submitAttempt() {
            const term = terms[currentTermIndex];
            const prefixZoneValue = document.getElementById("prefix-zone").innerHTML;
            const rootZoneValue = document.getElementById("root-zone").innerHTML;
            const suffixZoneValue = document.getElementById("suffix-zone").innerHTML;

            if (
                (prefixZoneValue === term.prefix || (term.prefix === "" && prefixZoneValue === "Prefix")) &&
                (rootZoneValue === term.root || (term.root === "" && rootZoneValue === "Root")) &&
                (suffixZoneValue === term.suffix || (term.suffix === "" && suffixZoneValue === "Suffix"))
            ) {
                document.getElementById("result").innerHTML = "Correct! " + term.meaning;
                score += 10;
                document.getElementById("score").innerHTML = score;
                setTimeout(nextTerm, 1000);
            } else {
                attempts++;
                if (attempts >= 2) {
                    showHint();
                } else {
                    document.getElementById("result").innerHTML = "Incorrect. Try again.";
                }
            }
        }

        function showHint() {
            const term = terms[currentTermIndex];
            const prefixZoneValue = document.getElementById("prefix-zone").innerHTML;
            const rootZoneValue = document.getElementById("root-zone").innerHTML;
            const suffixZoneValue = document.getElementById("suffix-zone").innerHTML;

            let hintMessage = "Hint: ";
            if (prefixZoneValue !== term.prefix) {
                hintMessage += `The correct prefix is "${term.prefix}". `;
            }
            if (rootZoneValue !== term.root) {
                hintMessage += `The correct root is "${term.root}". `;
            }
            if (suffixZoneValue !== term.suffix) {
                hintMessage += `The correct suffix is "${term.suffix}". `;
            }

            document.getElementById("hint").innerHTML = hintMessage;
            document.getElementById("hint").style.display = "block";

            setTimeout(nextTerm, 3000);
        }

        function nextTerm() {
            currentTermIndex++;
            if (currentTermIndex < terms.length) {
                resetTerm();
                loadTerm();
            } else {
                document.getElementById("result").innerHTML = "Congratulations! You've completed all the terms!";
                checkLeaderboard();
            }
        }

        function resetTerm() {
            document.getElementById("prefix-zone").innerHTML = "Prefix";
            document.getElementById("root-zone").innerHTML = "Root";
            document.getElementById("suffix-zone").innerHTML = "Suffix";
            document.getElementById("result").innerHTML = "";
            document.getElementById("hint").style.display = "none";
        }

        function resetGame() {
            score = 0;
            currentTermIndex = 0;
            shuffle(terms); // Shuffle the terms array each time the game is reset
            document.getElementById("score").innerHTML = score;
            resetTerm();
            loadTerm();
        }

        function checkLeaderboard() {
            const playerName = document.getElementById("playerName").value || "Anonymous";
            const newEntry = { name: playerName, score: score };

            leaderboard.push(newEntry);
            leaderboard.sort((a, b) => b.score - a.score);

            if (leaderboard.length > 10) {
                leaderboard.pop();
            }

            localStorage.setItem("leaderboard", JSON.stringify(leaderboard));

            displayLeaderboard();
        }

        function displayLeaderboard() {
            const leaderboardList = document.getElementById("leaderboard-list");
            leaderboardList.innerHTML = "";

            leaderboard.forEach((entry, index) => {
                const li = document.createElement("li");

                if (index === 0) {
                    const goldMedal = document.createElement("span");
                    goldMedal.classList.add("medal", "gold");
                    goldMedal.innerHTML = "🥇";
                    li.appendChild(goldMedal);
                } else if (index === 1) {
                    const silverMedal = document.createElement("span");
                    silverMedal.classList.add("medal", "silver");
                    silverMedal.innerHTML = "🥈";
                    li.appendChild(silverMedal);
                }

                li.appendChild(document.createTextNode(`${entry.name}: ${entry.score}`));
                leaderboardList.appendChild(li);
            });
        }
    </script>
</body>
</html>

